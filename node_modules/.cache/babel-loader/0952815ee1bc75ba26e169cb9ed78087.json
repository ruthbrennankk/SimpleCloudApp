{"remainingRequest":"/Users/ruthbrennan/WebstormProjects/ia2/node_modules/babel-loader/lib/index.js!/Users/ruthbrennan/WebstormProjects/ia2/node_modules/eslint-loader/index.js??ref--13-0!/Users/ruthbrennan/WebstormProjects/ia2/src/main.js","dependencies":[{"path":"/Users/ruthbrennan/WebstormProjects/ia2/src/main.js","mtime":1607101136263},{"path":"/Users/ruthbrennan/WebstormProjects/ia2/node_modules/cache-loader/dist/cjs.js","mtime":1604762669128},{"path":"/Users/ruthbrennan/WebstormProjects/ia2/node_modules/babel-loader/lib/index.js","mtime":1606831122563},{"path":"/Users/ruthbrennan/WebstormProjects/ia2/node_modules/eslint-loader/index.js","mtime":1604762673978}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:cmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZvci1lYWNoIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuam9pbiIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCIpOwoKcmVxdWlyZSgiL1VzZXJzL3J1dGhicmVubmFuL1dlYnN0b3JtUHJvamVjdHMvaWEyL25vZGVfbW9kdWxlcy9jb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaXRlcmF0b3IuanMiKTsKCnJlcXVpcmUoIi9Vc2Vycy9ydXRoYnJlbm5hbi9XZWJzdG9ybVByb2plY3RzL2lhMi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzLnByb21pc2UuanMiKTsKCnJlcXVpcmUoIi9Vc2Vycy9ydXRoYnJlbm5hbi9XZWJzdG9ybVByb2plY3RzL2lhMi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5hc3NpZ24uanMiKTsKCnJlcXVpcmUoIi9Vc2Vycy9ydXRoYnJlbm5hbi9XZWJzdG9ybVByb2plY3RzL2lhMi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzLnByb21pc2UuZmluYWxseS5qcyIpOwoKdmFyIGRlYnVnID0gMDsKCnZhciBleHByZXNzID0gcmVxdWlyZSgiZXhwcmVzcyIpOwoKdmFyIHBhdGggPSByZXF1aXJlKCJwYXRoIik7Cgp2YXIgZmV0Y2ggPSByZXF1aXJlKCJub2RlLWZldGNoIik7Cgp2YXIgYXBwID0gZXhwcmVzcygpOwoKdmFyIEFXUyA9IHJlcXVpcmUoImF3cy1zZGsiKTsKCnZhciBwb3J0ID0gMzAwMDsKdmFyIHB1YmxpY0tleSA9ICJBS0lBSkVHNlVESlJHMlM3Q1JVQSI7CnZhciBwcml2YXRlS2V5ID0gInNiWEp0a3BYcUtGVElwcENNUUpCOXlFQjNycmYyb1RtV2tpOWlsMDQiOwpBV1MuY29uZmlnLnVwZGF0ZSh7CiAgcmVnaW9uOiAiZXUtd2VzdC0xIiwKICBhY2Nlc3NLZXlJZDogcHVibGljS2V5LAogIHNlY3JldEFjY2Vzc0tleTogcHJpdmF0ZUtleQp9KTsKdmFyIGR5bmFtb2RiID0gbmV3IEFXUy5EeW5hbW9EQigpOwp2YXIgZG9jQ2xpZW50ID0gbmV3IEFXUy5EeW5hbW9EQi5Eb2N1bWVudENsaWVudCgpOwp2YXIgcHVibGljUGF0aCA9IHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsICJwdWJsaWMiKTsKYXBwLnVzZShleHByZXNzLnN0YXRpYyhwdWJsaWNQYXRoKSk7CmFwcC5nZXQoIi8iLCBmdW5jdGlvbiAocmVxLCByZXMpIHsKICByZXMuc2VuZEZpbGUocGF0aC5qb2luKF9fZGlybmFtZSArICIvaW5kZXguaHRtbCIpKTsKfSk7CmFwcC5saXN0ZW4ocG9ydCwgZnVuY3Rpb24gKCkgewogIGNvbnNvbGUubG9nKCJNb3ZpZSBBcHAgaXMgbGlzdGVuaW5nIG9uICIgKyBwb3J0KTsKfSk7CmFwcC5wb3N0KCcvY3JlYXRlJywgZnVuY3Rpb24gKHJlcSwgcmVzKSB7CiAgY29uc29sZS5sb2coIkNyZWF0aW5nIik7CiAgdmFyIHBhcmFtcyA9IHsKICAgIFRhYmxlTmFtZTogIk1vdmllcyIsCiAgICBLZXlTY2hlbWE6IFt7CiAgICAgIEF0dHJpYnV0ZU5hbWU6ICJ5ZWFyIiwKICAgICAgS2V5VHlwZTogIkhBU0giCiAgICB9LCAvL1BhcnRpdGlvbiBrZXkKICAgIHsKICAgICAgQXR0cmlidXRlTmFtZTogInRpdGxlIiwKICAgICAgS2V5VHlwZTogIlJBTkdFIgogICAgfSAvL1NvcnQga2V5CiAgICBdLAogICAgQXR0cmlidXRlRGVmaW5pdGlvbnM6IFt7CiAgICAgIEF0dHJpYnV0ZU5hbWU6ICJ5ZWFyIiwKICAgICAgQXR0cmlidXRlVHlwZTogIk4iCiAgICB9LCB7CiAgICAgIEF0dHJpYnV0ZU5hbWU6ICJ0aXRsZSIsCiAgICAgIEF0dHJpYnV0ZVR5cGU6ICJTIgogICAgfV0sCiAgICBQcm92aXNpb25lZFRocm91Z2hwdXQ6IHsKICAgICAgUmVhZENhcGFjaXR5VW5pdHM6IDEwLAogICAgICBXcml0ZUNhcGFjaXR5VW5pdHM6IDEwCiAgICB9CiAgfTsKICBkeW5hbW9kYi5jcmVhdGVUYWJsZShwYXJhbXMsIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHsKICAgIGlmIChlcnIpIHsKICAgICAgY29uc29sZS5lcnJvcigiVW5hYmxlIHRvIGNyZWF0ZSB0YWJsZS4gRXJyb3IgSlNPTjoiLCBKU09OLnN0cmluZ2lmeShlcnIsIG51bGwsIDIpKTsKICAgIH0gZWxzZSB7CiAgICAgIGNvbnNvbGUubG9nKCJDcmVhdGVkIHRhYmxlLiBUYWJsZSBkZXNjcmlwdGlvbiBKU09OOiIsIEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDIpKTsKICAgIH0KICB9KTsKICB2YXIgczNwYXJhbXMgPSB7CiAgICBCdWNrZXQ6ICdjc3U0NDAwMGFzc2lnbm1lbnQyJywKICAgIEtleTogJ21vdmllZGF0YS5qc29uJwogIH07CiAgdmFyIHMzID0gbmV3IEFXUy5TMygpOwogIHMzLmdldE9iamVjdChzM3BhcmFtcywgZnVuY3Rpb24gKGVyciwgZGF0YSkgewogICAgaWYgKGVycikgewogICAgICBjb25zb2xlLmxvZyhlcnIsIGVyci5zdGFjayk7CiAgICB9IGVsc2UgewogICAgICB2YXIgYWxsTW92aWVzID0gSlNPTi5wYXJzZShkYXRhLkJvZHkudG9TdHJpbmcoKSk7CiAgICAgIGFsbE1vdmllcy5mb3JFYWNoKGZ1bmN0aW9uIChtb3ZpZSkgewogICAgICAgIHZhciBwYXJhbXMgPSB7CiAgICAgICAgICBUYWJsZU5hbWU6ICJNb3ZpZXMiLAogICAgICAgICAgSXRlbTogewogICAgICAgICAgICAieWVhciI6IG1vdmllLnllYXIsCiAgICAgICAgICAgICJ0aXRsZSI6IG1vdmllLnRpdGxlLAogICAgICAgICAgICAiZGlyZWN0b3IiOiBtb3ZpZS5pbmZvLmRpcmVjdG9ycywKICAgICAgICAgICAgInJhdGluZyI6IG1vdmllLmluZm8ucmF0aW5nLAogICAgICAgICAgICAicmFuayI6IG1vdmllLmluZm8ucmFuaywKICAgICAgICAgICAgInJlbGVhc2UiOiBtb3ZpZS5pbmZvLnJlbGVhc2VfZGF0ZQogICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgZG9jQ2xpZW50LnB1dChwYXJhbXMsIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHsKICAgICAgICAgIGlmIChlcnIpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcigiVW5hYmxlIHRvIGFkZCBtb3ZpZSIsIG1vdmllLnRpdGxlLCAiLiBFcnJvciBKU09OOiIsIEpTT04uc3RyaW5naWZ5KGVyciwgbnVsbCwgMikpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS5sb2coInN1Y2NlZWRlZCBpbiBhZGRpbmcgbW92aWU6IiwgbW92aWUudGl0bGUpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KCiAgICBjb25zb2xlLmxvZygiRGF0YWJhc2UgY3JlYXRlZCBzdWNjZXNzZnVsbHkiKTsKICB9KTsKfSk7CmFwcC5wb3N0KCcvcXVlcnkvOnRpdGxlLzp5ZWFyJywgZnVuY3Rpb24gKHJlcSwgcmVzKSB7CiAgY29uc29sZS5sb2coIlF1ZXJ5IHRpbWUiKTsKICB2YXIgbXlBcnJheSA9IHsKICAgIG15TGlzdDogW10KICB9OwogIHZhciB5ZWFyID0gcGFyc2VJbnQocmVxLnBhcmFtcy55ZWFyKTsKICB2YXIgdGl0bGUgPSByZXEucGFyYW1zLnRpdGxlOwogIHZhciBwYXJhbXMgPSB7CiAgICBUYWJsZU5hbWU6ICJNb3ZpZXMiLAogICAgUHJvamVjdGlvbkV4cHJlc3Npb246ICIjeXIsIHRpdGxlLCBkaXJlY3RvciwgcmF0aW5nLCAjciwgI3JlIiwKICAgIEtleUNvbmRpdGlvbkV4cHJlc3Npb246ICIjeXIgPSA6eXl5eSBhbmQgYmVnaW5zX3dpdGggKHRpdGxlLCA6bGV0dGVyMSkiLAogICAgRXhwcmVzc2lvbkF0dHJpYnV0ZU5hbWVzOiB7CiAgICAgICIjeXIiOiAieWVhciIsCiAgICAgICIjciI6ICJyYW5rIiwKICAgICAgIiNyZSI6ICJyZWxlYXNlIgogICAgfSwKICAgIEV4cHJlc3Npb25BdHRyaWJ1dGVWYWx1ZXM6IHsKICAgICAgIjp5eXl5IjogeWVhciwKICAgICAgIjpsZXR0ZXIxIjogdGl0bGUKICAgIH0KICB9OwogIGRvY0NsaWVudC5xdWVyeShwYXJhbXMsIGZ1bmN0aW9uIChlcnIsIGRhdGEpIHsKICAgIGlmIChlcnIpIHsKICAgICAgY29uc29sZS5sb2coIlVuYWJsZSB0byBxdWVyeS4gRXJyb3I6IiwgSlNPTi5zdHJpbmdpZnkoZXJyLCBudWxsLCAyKSk7CiAgICB9IGVsc2UgewogICAgICBjb25zb2xlLmxvZygiUXVlcnkgc3VjY2VlZGVkLiIpOwogICAgICBkYXRhLkl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICBjb25zb2xlLmxvZyhpdGVtLnllYXIgKyAnICcgKyBpdGVtLnRpdGxlICsgJycgKyBpdGVtLmRpcmVjdG9yICsgJycgKyBpdGVtLnJhdGluZyk7CiAgICAgICAgdmFyIHllYXJQdXNoID0gaXRlbS55ZWFyOwogICAgICAgIHZhciB0aXRsZVB1c2ggPSBpdGVtLnRpdGxlOwogICAgICAgIHZhciBkaXJlY3RvclB1c2ggPSBpdGVtLmRpcmVjdG9yOwogICAgICAgIHZhciByYXRpbmdQdXNoID0gaXRlbS5yYXRpbmc7CiAgICAgICAgdmFyIHJhbmtQdXNoID0gaXRlbS5yYW5rOwogICAgICAgIHZhciByZWxlYXNlUHVzaCA9IGl0ZW0ucmVsZWFzZTsKICAgICAgICBteUFycmF5Lm15TGlzdC5wdXNoKHsKICAgICAgICAgIFRpdGxlOiB0aXRsZVB1c2gsCiAgICAgICAgICBZZWFyOiB5ZWFyUHVzaCwKICAgICAgICAgIERpcmVjdG9yOiBkaXJlY3RvclB1c2gsCiAgICAgICAgICBSYXRpbmc6IHJhdGluZ1B1c2gsCiAgICAgICAgICBSYW5rOiByYW5rUHVzaCwKICAgICAgICAgIFJlbGVhc2U6IHJlbGVhc2VQdXNoCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICBjb25zb2xlLmxvZygnRG9uZSBQcmludGluZycpOwogICAgICByZXMuanNvbihteUFycmF5KTsKICAgIH0KICB9KTsKfSk7CmFwcC5wb3N0KCcvZGVzdHJveScsIGZ1bmN0aW9uIChyZXEsIHJlcykgewogIGNvbnNvbGUubG9nKCJEZXN0cm95aW5nIik7CiAgdmFyIHBhcmFtcyA9IHsKICAgIFRhYmxlTmFtZTogIk1vdmllcyIKICB9OwogIGR5bmFtb2RiLmRlbGV0ZVRhYmxlKHBhcmFtcywgZnVuY3Rpb24gKGVyciwgZGF0YSkgewogICAgaWYgKGVycikgewogICAgICBjb25zb2xlLmVycm9yKCJVbmFibGUgdG8gZGVsZXRlIHRhYmxlLiBFcnJvciBKU09OOiIsIEpTT04uc3RyaW5naWZ5KGVyciwgbnVsbCwgMikpOwogICAgfSBlbHNlIHsKICAgICAgY29uc29sZS5sb2coIkRlbGV0ZWQgdGFibGUuIFRhYmxlIGRlc2NyaXB0aW9uIEpTT046IiwgSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgMikpOwogICAgfQogIH0pOwp9KTs="},{"version":3,"sources":["/Users/ruthbrennan/WebstormProjects/ia2/src/main.js"],"names":["debug","express","require","path","fetch","app","AWS","port","publicKey","privateKey","config","update","region","accessKeyId","secretAccessKey","dynamodb","DynamoDB","docClient","DocumentClient","publicPath","resolve","__dirname","use","static","get","req","res","sendFile","join","listen","console","log","post","params","TableName","KeySchema","AttributeName","KeyType","AttributeDefinitions","AttributeType","ProvisionedThroughput","ReadCapacityUnits","WriteCapacityUnits","createTable","err","data","error","JSON","stringify","s3params","Bucket","Key","s3","S3","getObject","stack","allMovies","parse","Body","toString","forEach","movie","Item","year","title","info","directors","rating","rank","release_date","put","myArray","myList","parseInt","ProjectionExpression","KeyConditionExpression","ExpressionAttributeNames","ExpressionAttributeValues","query","Items","item","director","yearPush","titlePush","directorPush","ratingPush","rankPush","releasePush","release","push","Title","Year","Director","Rating","Rank","Release","json","deleteTable"],"mappings":"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","sourcesContent":["var debug = 0\nconst express = require(\"express\")\nconst path = require(\"path\")\nconst fetch = require(\"node-fetch\")\nconst app = express()\nconst AWS = require(\"aws-sdk\");\nconst port = 3000\nconst publicKey = \"AKIAJEG6UDJRG2S7CRUA\"\nconst privateKey = \"sbXJtkpXqKFTIppCMQJB9yEB3rrf2oTmWki9il04\"\n\n\nAWS.config.update({\n  region: \"eu-west-1\",\n  accessKeyId: publicKey,\n  secretAccessKey: privateKey\n});\n\nvar dynamodb = new AWS.DynamoDB();\nvar docClient = new AWS.DynamoDB.DocumentClient();\n\nlet publicPath = path.resolve(__dirname, \"public\")\napp.use(express.static(publicPath))\napp.get(\"/\", function (req, res) {\n  res.sendFile(path.join(__dirname + \"/index.html\"))\n})\n\n\napp.listen(port, function () {\n  console.log(\"Movie App is listening on \" +port)\n})\n\napp.post('/create', (req, res) => {\n  console.log(\"Creating\")\n  var params = {\n    TableName: \"Movies\",\n    KeySchema: [\n      { AttributeName: \"year\", KeyType: \"HASH\" },  //Partition key\n      { AttributeName: \"title\", KeyType: \"RANGE\" }  //Sort key\n    ],\n    AttributeDefinitions: [\n      { AttributeName: \"year\", AttributeType: \"N\" },\n      { AttributeName: \"title\", AttributeType: \"S\" }\n    ],\n    ProvisionedThroughput: {\n      ReadCapacityUnits: 10,\n      WriteCapacityUnits: 10\n    }\n  };\n  dynamodb.createTable(params, function (err, data) {\n    if (err) {\n      console.error(\"Unable to create table. Error JSON:\", JSON.stringify(err, null, 2));\n    } else {\n      console.log(\"Created table. Table description JSON:\", JSON.stringify(data, null, 2));\n    }\n  });\n  var s3params = {\n    Bucket: 'csu44000assignment2',\n    Key: 'moviedata.json'\n  }\n  var s3 = new AWS.S3();\n  s3.getObject(s3params, function (err, data) {\n    if (err) {\n      console.log(err, err.stack);\n    } else {\n      var allMovies = JSON.parse(data.Body.toString());\n      allMovies.forEach(function (movie) {\n        var params = {\n          TableName: \"Movies\",\n          Item: {\n            \"year\": movie.year,\n            \"title\": movie.title,\n            \"director\":  movie.info.directors,\n            \"rating\": movie.info.rating,\n            \"rank\": movie.info.rank,\n            \"release\": movie.info.release_date\n          }\n        };\n\n\n        docClient.put(params, function (err, data) {\n          if (err) {\n            console.error(\"Unable to add movie\", movie.title, \". Error JSON:\", JSON.stringify(err, null, 2));\n          } else {\n            console.log(\"succeeded in adding movie:\", movie.title);\n          }\n        });\n      });\n    }\n    console.log(\"Database created successfully\");\n  })\n});\n\n\napp.post('/query/:title/:year', (req, res) => {\n  console.log(\"Query time\")\n  var myArray = {\n    myList :[]\n  }\n  var year = parseInt(req.params.year)\n  var title = req.params.title\n  var params = {\n    TableName : \"Movies\",\n    ProjectionExpression:\"#yr, title, director, rating, #r, #re\",\n    KeyConditionExpression: \"#yr = :yyyy and begins_with (title, :letter1)\",\n    ExpressionAttributeNames:{\n      \"#yr\": \"year\",\n      \"#r\":\"rank\",\n      \"#re\":\"release\"\n    },\n    ExpressionAttributeValues: {\n      \":yyyy\": year,\n      \":letter1\": title\n    }\n  };\n\n  docClient.query(params, function(err, data) {\n    if (err) {\n      console.log(\"Unable to query. Error:\", JSON.stringify(err, null, 2));\n    } else {\n      console.log(\"Query succeeded.\");\n      data.Items.forEach(function(item) {\n        console.log(item.year +' '+ item.title+'' + item.director+'' + item.rating);\n        var yearPush = item.year\n        var titlePush = item.title\n        var directorPush = item.director\n        var ratingPush = item.rating\n        var rankPush = item.rank\n        var releasePush = item.release\n        myArray.myList.push(\n            {\n              Title: titlePush,\n              Year : yearPush,\n              Director: directorPush,\n              Rating: ratingPush,\n              Rank: rankPush,\n              Release: releasePush\n            }\n        )\n      });\n      console.log('Done Printing')\n      res.json(myArray)\n    }\n  });\n});\n\n\n\napp.post('/destroy', (req, res) => {\n  console.log(\"Destroying\");\n  var params = {\n    TableName : \"Movies\",\n  };\n  dynamodb.deleteTable(params, function(err, data) {\n    if (err) {\n      console.error(\"Unable to delete table. Error JSON:\", JSON.stringify(err, null, 2));\n    } else {\n      console.log(\"Deleted table. Table description JSON:\", JSON.stringify(data, null, 2));\n    }\n  });\n});"]}]}